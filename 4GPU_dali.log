Namespace(batch_norm=False, batch_size=32, batchnorm_layout='NCHW', conv_layout='NCHW', crop_ratio=0.875, dali_fuse_decoder=1, dali_nvjpeg_memory_padding=64, dali_prefetch_queue=2, dali_separ_val=False, dali_threads=3, dali_validation_threads=10, data_backend='dali-gpu', data_dir='/data/imagenet/train-480-val-256-recordio', data_pred=None, data_val_resize=256, dtype='float32', flag=1, hard_weight=0.5, image_shape=[3, 224, 224], input_layout='NCHW', input_size=224, kv_store='device', label_smoothing=False, last_gamma=False, log_interval=50, logging_file='train_imagenet.log', lr=0.1, lr_decay=0.1, lr_decay_epoch='40,60', lr_decay_period=0, lr_mode='step', mixup=False, mixup_alpha=0.2, mixup_off_epoch=0, mode=None, model='resnet18_v1', momentum=0.9, no_wd=False, num_epochs=3, num_examples=1281167, num_gpus=4, num_training_samples=1281167, num_workers=4, pooling_layout='NCHW', rec_train='/data/imagenet/train-480-val-256-recordio/train.rec', rec_train_idx='/data/imagenet/train-480-val-256-recordio/train.idx', rec_val='/data/imagenet/train-480-val-256-recordio/val.rec', rec_val_idx='/data/imagenet/train-480-val-256-recordio/val.idx', resume_epoch=0, resume_params='', resume_states='', rgb_mean=[123.68, 116.779, 103.939], rgb_std=[58.393, 57.12, 57.375], save_dir='params', save_frequency=10, teacher=None, temperature=20, use_gn=False, use_pretrained=False, use_rec=True, use_se=False, warmup_epochs=0, warmup_lr=0.0, wd=0.0001)
DALI iterator does not support resetting while epoch is not finished. Ignoring...
Epoch[0] Batch [50]	Speed: 1279.513003 samples/sec	accuracy=0.002773	lr=0.100000
Epoch[0] Batch [100]	Speed: 1613.370333 samples/sec	accuracy=0.003926	lr=0.100000
Epoch[0] Batch [150]	Speed: 1626.221601 samples/sec	accuracy=0.005065	lr=0.100000
Epoch[0] Batch [200]	Speed: 1609.952197 samples/sec	accuracy=0.006348	lr=0.100000
Epoch[0] Batch [250]	Speed: 1636.611255 samples/sec	accuracy=0.007789	lr=0.100000
Epoch[0] Batch [300]	Speed: 1615.412077 samples/sec	accuracy=0.009915	lr=0.100000
Epoch[0] Batch [350]	Speed: 1629.728143 samples/sec	accuracy=0.011942	lr=0.100000
Epoch[0] Batch [400]	Speed: 1671.233896 samples/sec	accuracy=0.014194	lr=0.100000
Epoch[0] Batch [450]	Speed: 1666.367803 samples/sec	accuracy=0.016510	lr=0.100000
Epoch[0] Batch [500]	Speed: 1669.364838 samples/sec	accuracy=0.018801	lr=0.100000
Epoch[0] Batch [550]	Speed: 1633.682423 samples/sec	accuracy=0.021424	lr=0.100000
Epoch[0] Batch [600]	Speed: 1624.547372 samples/sec	accuracy=0.023994	lr=0.100000
Epoch[0] Batch [650]	Speed: 1629.355506 samples/sec	accuracy=0.026544	lr=0.100000
Epoch[0] Batch [700]	Speed: 1603.475498 samples/sec	accuracy=0.029085	lr=0.100000
Epoch[0] Batch [750]	Speed: 1621.272318 samples/sec	accuracy=0.031633	lr=0.100000
Epoch[0] Batch [800]	Speed: 1624.669957 samples/sec	accuracy=0.034209	lr=0.100000
Epoch[0] Batch [850]	Speed: 1625.543581 samples/sec	accuracy=0.036838	lr=0.100000
Epoch[0] Batch [900]	Speed: 1643.611374 samples/sec	accuracy=0.039618	lr=0.100000
Epoch[0] Batch [950]	Speed: 1650.106348 samples/sec	accuracy=0.042453	lr=0.100000
Epoch[0] Batch [1000]	Speed: 1630.059649 samples/sec	accuracy=0.045166	lr=0.100000
Epoch[0] Batch [1050]	Speed: 1675.289603 samples/sec	accuracy=0.047943	lr=0.100000
Epoch[0] Batch [1100]	Speed: 1669.204821 samples/sec	accuracy=0.050664	lr=0.100000
Epoch[0] Batch [1150]	Speed: 1649.785372 samples/sec	accuracy=0.053322	lr=0.100000
Epoch[0] Batch [1200]	Speed: 1615.442286 samples/sec	accuracy=0.055986	lr=0.100000
Epoch[0] Batch [1250]	Speed: 1622.519163 samples/sec	accuracy=0.058734	lr=0.100000
Epoch[0] Batch [1300]	Speed: 1633.989928 samples/sec	accuracy=0.061402	lr=0.100000
Epoch[0] Batch [1350]	Speed: 1641.116170 samples/sec	accuracy=0.064047	lr=0.100000
Epoch[0] Batch [1400]	Speed: 1634.220837 samples/sec	accuracy=0.066763	lr=0.100000
Epoch[0] Batch [1450]	Speed: 1633.009643 samples/sec	accuracy=0.069495	lr=0.100000
Epoch[0] Batch [1500]	Speed: 1681.440473 samples/sec	accuracy=0.072021	lr=0.100000
Epoch[0] Batch [1550]	Speed: 1672.055552 samples/sec	accuracy=0.074647	lr=0.100000
Epoch[0] Batch [1600]	Speed: 1675.419626 samples/sec	accuracy=0.077141	lr=0.100000
Epoch[0] Batch [1650]	Speed: 1675.128893 samples/sec	accuracy=0.079683	lr=0.100000
Epoch[0] Batch [1700]	Speed: 1645.609636 samples/sec	accuracy=0.082134	lr=0.100000
Epoch[0] Batch [1750]	Speed: 1635.787896 samples/sec	accuracy=0.084691	lr=0.100000
Epoch[0] Batch [1800]	Speed: 1654.222006 samples/sec	accuracy=0.087143	lr=0.100000
Epoch[0] Batch [1850]	Speed: 1639.776781 samples/sec	accuracy=0.089567	lr=0.100000
Epoch[0] Batch [1900]	Speed: 1652.404542 samples/sec	accuracy=0.091955	lr=0.100000
Epoch[0] Batch [1950]	Speed: 1671.013447 samples/sec	accuracy=0.094253	lr=0.100000
Epoch[0] Batch [2000]	Speed: 1641.090310 samples/sec	accuracy=0.096548	lr=0.100000
Epoch[0] Batch [2050]	Speed: 1623.431317 samples/sec	accuracy=0.098851	lr=0.100000
Epoch[0] Batch [2100]	Speed: 1607.368464 samples/sec	accuracy=0.101030	lr=0.100000
Epoch[0] Batch [2150]	Speed: 1621.965693 samples/sec	accuracy=0.103300	lr=0.100000
Epoch[0] Batch [2200]	Speed: 1650.836642 samples/sec	accuracy=0.105559	lr=0.100000
Epoch[0] Batch [2250]	Speed: 1664.520935 samples/sec	accuracy=0.107786	lr=0.100000
Epoch[0] Batch [2300]	Speed: 1666.724965 samples/sec	accuracy=0.110029	lr=0.100000
Epoch[0] Batch [2350]	Speed: 1649.202939 samples/sec	accuracy=0.112147	lr=0.100000
Epoch[0] Batch [2400]	Speed: 1640.010582 samples/sec	accuracy=0.114262	lr=0.100000
Epoch[0] Batch [2450]	Speed: 1639.046605 samples/sec	accuracy=0.116358	lr=0.100000
Epoch[0] Batch [2500]	Speed: 1667.149398 samples/sec	accuracy=0.118448	lr=0.100000
Epoch[0] Batch [2502]	Speed: 1076.395947 samples/sec	accuracy=0.118565	lr=0.100000
DALI iterator does not support resetting while epoch is not finished. Ignoring...
[Epoch 0] training: accuracy=0.118565
[Epoch 0] speed: 1632 samples/sec	time cost: 784.898536
[Epoch 0] validation: err-top1=0.763114 err-top5=0.523996
Epoch[1] Batch [50]	Speed: 1632.864367 samples/sec	accuracy=0.218047	lr=0.100000
Epoch[1] Batch [100]	Speed: 1648.409429 samples/sec	accuracy=0.220352	lr=0.100000
Epoch[1] Batch [150]	Speed: 1615.415674 samples/sec	accuracy=0.221263	lr=0.100000
Epoch[1] Batch [200]	Speed: 1615.702166 samples/sec	accuracy=0.222812	lr=0.100000
Epoch[1] Batch [250]	Speed: 1570.768144 samples/sec	accuracy=0.224781	lr=0.100000
Epoch[1] Batch [300]	Speed: 1621.207620 samples/sec	accuracy=0.225625	lr=0.100000
Epoch[1] Batch [350]	Speed: 1588.564392 samples/sec	accuracy=0.227355	lr=0.100000
Epoch[1] Batch [400]	Speed: 1638.918139 samples/sec	accuracy=0.228911	lr=0.100000
Epoch[1] Batch [450]	Speed: 1671.546099 samples/sec	accuracy=0.230352	lr=0.100000
Epoch[1] Batch [500]	Speed: 1673.198891 samples/sec	accuracy=0.231703	lr=0.100000
Epoch[1] Batch [550]	Speed: 1672.974561 samples/sec	accuracy=0.233562	lr=0.100000
Epoch[1] Batch [600]	Speed: 1631.944486 samples/sec	accuracy=0.234492	lr=0.100000
Epoch[1] Batch [650]	Speed: 1618.194105 samples/sec	accuracy=0.235589	lr=0.100000
Epoch[1] Batch [700]	Speed: 1583.483125 samples/sec	accuracy=0.236934	lr=0.100000
Epoch[1] Batch [750]	Speed: 1639.082584 samples/sec	accuracy=0.238094	lr=0.100000
Epoch[1] Batch [800]	Speed: 1647.158446 samples/sec	accuracy=0.239138	lr=0.100000
Epoch[1] Batch [850]	Speed: 1639.769869 samples/sec	accuracy=0.240113	lr=0.100000
Epoch[1] Batch [900]	Speed: 1639.988789 samples/sec	accuracy=0.241033	lr=0.100000
Epoch[1] Batch [950]	Speed: 1593.741035 samples/sec	accuracy=0.242076	lr=0.100000
Epoch[1] Batch [1000]	Speed: 1613.855537 samples/sec	accuracy=0.243066	lr=0.100000
Epoch[1] Batch [1050]	Speed: 1649.496270 samples/sec	accuracy=0.243960	lr=0.100000
Epoch[1] Batch [1100]	Speed: 1621.643055 samples/sec	accuracy=0.244693	lr=0.100000
Epoch[1] Batch [1150]	Speed: 1641.949498 samples/sec	accuracy=0.245555	lr=0.100000
Epoch[1] Batch [1200]	Speed: 1654.136355 samples/sec	accuracy=0.246364	lr=0.100000
Epoch[1] Batch [1250]	Speed: 1618.525399 samples/sec	accuracy=0.247225	lr=0.100000
Epoch[1] Batch [1300]	Speed: 1657.896602 samples/sec	accuracy=0.248110	lr=0.100000
Epoch[1] Batch [1350]	Speed: 1644.784029 samples/sec	accuracy=0.248902	lr=0.100000
Epoch[1] Batch [1400]	Speed: 1647.486035 samples/sec	accuracy=0.249738	lr=0.100000
Epoch[1] Batch [1450]	Speed: 1671.407935 samples/sec	accuracy=0.250673	lr=0.100000
Epoch[1] Batch [1500]	Speed: 1655.241813 samples/sec	accuracy=0.251427	lr=0.100000
Epoch[1] Batch [1550]	Speed: 1627.622539 samples/sec	accuracy=0.252263	lr=0.100000
Epoch[1] Batch [1600]	Speed: 1617.529681 samples/sec	accuracy=0.252999	lr=0.100000
Epoch[1] Batch [1650]	Speed: 1653.957615 samples/sec	accuracy=0.253928	lr=0.100000
Epoch[1] Batch [1700]	Speed: 1627.795855 samples/sec	accuracy=0.254563	lr=0.100000
Epoch[1] Batch [1750]	Speed: 1617.114425 samples/sec	accuracy=0.255395	lr=0.100000
Epoch[1] Batch [1800]	Speed: 1637.632010 samples/sec	accuracy=0.256239	lr=0.100000
Epoch[1] Batch [1850]	Speed: 1582.650079 samples/sec	accuracy=0.257155	lr=0.100000
Epoch[1] Batch [1900]	Speed: 1657.903616 samples/sec	accuracy=0.257953	lr=0.100000
Epoch[1] Batch [1950]	Speed: 1659.143214 samples/sec	accuracy=0.258688	lr=0.100000
Epoch[1] Batch [2000]	Speed: 1626.279188 samples/sec	accuracy=0.259368	lr=0.100000
Epoch[1] Batch [2050]	Speed: 1625.521113 samples/sec	accuracy=0.260054	lr=0.100000
Epoch[1] Batch [2100]	Speed: 1640.138969 samples/sec	accuracy=0.260625	lr=0.100000
Epoch[1] Batch [2150]	Speed: 1628.316888 samples/sec	accuracy=0.261410	lr=0.100000
Epoch[1] Batch [2200]	Speed: 1608.060856 samples/sec	accuracy=0.262064	lr=0.100000
Epoch[1] Batch [2250]	Speed: 1629.899607 samples/sec	accuracy=0.262767	lr=0.100000
Epoch[1] Batch [2300]	Speed: 1626.517138 samples/sec	accuracy=0.263534	lr=0.100000
Epoch[1] Batch [2350]	Speed: 1665.523126 samples/sec	accuracy=0.264225	lr=0.100000
Epoch[1] Batch [2400]	Speed: 1669.068082 samples/sec	accuracy=0.264858	lr=0.100000
Epoch[1] Batch [2450]	Speed: 1560.055170 samples/sec	accuracy=0.265566	lr=0.100000
Epoch[1] Batch [2500]	Speed: 1642.139315 samples/sec	accuracy=0.266321	lr=0.100000
Epoch[1] Batch [2501]	Speed: 798.919803 samples/sec	accuracy=0.266337	lr=0.100000
[Epoch 1] training: accuracy=0.266337
[Epoch 1] speed: 1631 samples/sec	time cost: 784.959073
[Epoch 1] validation: err-top1=0.672652 err-top5=0.410555
Epoch[2] Batch [50]	Speed: 1612.795590 samples/sec	accuracy=0.292773	lr=0.100000
Epoch[2] Batch [100]	Speed: 1642.432727 samples/sec	accuracy=0.295664	lr=0.100000
Epoch[2] Batch [150]	Speed: 1632.484411 samples/sec	accuracy=0.296719	lr=0.100000
Epoch[2] Batch [200]	Speed: 1616.677548 samples/sec	accuracy=0.298564	lr=0.100000
Epoch[2] Batch [250]	Speed: 1655.265339 samples/sec	accuracy=0.299336	lr=0.100000
Epoch[2] Batch [300]	Speed: 1649.026605 samples/sec	accuracy=0.300482	lr=0.100000
Epoch[2] Batch [350]	Speed: 1615.147019 samples/sec	accuracy=0.301122	lr=0.100000
Epoch[2] Batch [400]	Speed: 1636.205319 samples/sec	accuracy=0.301479	lr=0.100000
Epoch[2] Batch [450]	Speed: 1633.036963 samples/sec	accuracy=0.302287	lr=0.100000
Epoch[2] Batch [500]	Speed: 1663.341416 samples/sec	accuracy=0.302402	lr=0.100000
Epoch[2] Batch [550]	Speed: 1659.951893 samples/sec	accuracy=0.303036	lr=0.100000
Epoch[2] Batch [600]	Speed: 1644.216526 samples/sec	accuracy=0.303678	lr=0.100000
Epoch[2] Batch [650]	Speed: 1654.978319 samples/sec	accuracy=0.304138	lr=0.100000
Epoch[2] Batch [700]	Speed: 1658.873685 samples/sec	accuracy=0.304035	lr=0.100000
Epoch[2] Batch [750]	Speed: 1658.248989 samples/sec	accuracy=0.304552	lr=0.100000
Epoch[2] Batch [800]	Speed: 1593.496945 samples/sec	accuracy=0.304644	lr=0.100000
Epoch[2] Batch [850]	Speed: 1615.107200 samples/sec	accuracy=0.304920	lr=0.100000
Epoch[2] Batch [900]	Speed: 1657.306484 samples/sec	accuracy=0.305451	lr=0.100000
Epoch[2] Batch [950]	Speed: 1630.768637 samples/sec	accuracy=0.305648	lr=0.100000
Epoch[2] Batch [1000]	Speed: 1614.092291 samples/sec	accuracy=0.306029	lr=0.100000
Epoch[2] Batch [1050]	Speed: 1618.202372 samples/sec	accuracy=0.306393	lr=0.100000
Epoch[2] Batch [1100]	Speed: 1626.439579 samples/sec	accuracy=0.306722	lr=0.100000
Epoch[2] Batch [1150]	Speed: 1659.440375 samples/sec	accuracy=0.307038	lr=0.100000
Epoch[2] Batch [1200]	Speed: 1622.469957 samples/sec	accuracy=0.307362	lr=0.100000
Epoch[2] Batch [1250]	Speed: 1647.742951 samples/sec	accuracy=0.307742	lr=0.100000
Epoch[2] Batch [1300]	Speed: 1615.159434 samples/sec	accuracy=0.308057	lr=0.100000
Epoch[2] Batch [1350]	Speed: 1642.814261 samples/sec	accuracy=0.308497	lr=0.100000
Epoch[2] Batch [1400]	Speed: 1585.467062 samples/sec	accuracy=0.308873	lr=0.100000
Epoch[2] Batch [1450]	Speed: 1637.160214 samples/sec	accuracy=0.309364	lr=0.100000
Epoch[2] Batch [1500]	Speed: 1615.632952 samples/sec	accuracy=0.309629	lr=0.100000
Epoch[2] Batch [1550]	Speed: 1628.677810 samples/sec	accuracy=0.310024	lr=0.100000
Epoch[2] Batch [1600]	Speed: 1657.039622 samples/sec	accuracy=0.310336	lr=0.100000
Epoch[2] Batch [1650]	Speed: 1632.870748 samples/sec	accuracy=0.310531	lr=0.100000
Epoch[2] Batch [1700]	Speed: 1593.921596 samples/sec	accuracy=0.310894	lr=0.100000
Epoch[2] Batch [1750]	Speed: 1630.589413 samples/sec	accuracy=0.311286	lr=0.100000
Epoch[2] Batch [1800]	Speed: 1631.302381 samples/sec	accuracy=0.311762	lr=0.100000
Epoch[2] Batch [1850]	Speed: 1636.764484 samples/sec	accuracy=0.312122	lr=0.100000
Epoch[2] Batch [1900]	Speed: 1608.971914 samples/sec	accuracy=0.312486	lr=0.100000
Epoch[2] Batch [1950]	Speed: 1615.711453 samples/sec	accuracy=0.312778	lr=0.100000
Epoch[2] Batch [2000]	Speed: 1607.929520 samples/sec	accuracy=0.313090	lr=0.100000
Epoch[2] Batch [2050]	Speed: 1633.814445 samples/sec	accuracy=0.313360	lr=0.100000
Epoch[2] Batch [2100]	Speed: 1632.622073 samples/sec	accuracy=0.313595	lr=0.100000
Epoch[2] Batch [2150]	Speed: 1650.404263 samples/sec	accuracy=0.313997	lr=0.100000
Epoch[2] Batch [2200]	Speed: 1652.437448 samples/sec	accuracy=0.314347	lr=0.100000
Epoch[2] Batch [2250]	Speed: 1651.822139 samples/sec	accuracy=0.314595	lr=0.100000
Epoch[2] Batch [2300]	Speed: 1649.822331 samples/sec	accuracy=0.315040	lr=0.100000
Epoch[2] Batch [2350]	Speed: 1668.994895 samples/sec	accuracy=0.315264	lr=0.100000
Epoch[2] Batch [2400]	Speed: 1558.952307 samples/sec	accuracy=0.315636	lr=0.100000
Epoch[2] Batch [2450]	Speed: 1573.582961 samples/sec	accuracy=0.315895	lr=0.100000
Epoch[2] Batch [2500]	Speed: 1609.450254 samples/sec	accuracy=0.316164	lr=0.100000
Epoch[2] Batch [2501]	Speed: 819.832363 samples/sec	accuracy=0.316182	lr=0.100000
[Epoch 2] training: accuracy=0.316182
[Epoch 2] speed: 1629 samples/sec	time cost: 785.700138
[Epoch 2] validation: err-top1=0.641189 err-top5=0.377034
Training time for 3 epochs: 2412.448937 sec.
