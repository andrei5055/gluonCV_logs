Namespace(batch_norm=False, batch_size=32, batchnorm_layout='NCHW', conv_layout='NCHW', crop_ratio=0.875, dali_fuse_decoder=1, dali_nvjpeg_memory_padding=64, dali_prefetch_queue=2, dali_separ_val=False, dali_threads=3, dali_validation_threads=10, data_backend='dali-gpu', data_dir='/data/imagenet/train-480-val-256-recordio', data_pred=None, data_val_resize=256, dtype='float32', flag=1, hard_weight=0.5, image_shape=[3, 224, 224], input_layout='NCHW', input_size=224, kv_store='device', label_smoothing=False, last_gamma=False, log_interval=50, logging_file='train_imagenet.log', lr=0.1, lr_decay=0.1, lr_decay_epoch='40,60', lr_decay_period=0, lr_mode='step', mixup=False, mixup_alpha=0.2, mixup_off_epoch=0, mode=None, model='resnet18_v1', momentum=0.9, no_wd=False, num_epochs=3, num_examples=1281167, num_gpus=4, num_training_samples=1281167, num_workers=4, pooling_layout='NCHW', rec_train='/data/imagenet/train-480-val-256-recordio/train.rec', rec_train_idx='/data/imagenet/train-480-val-256-recordio/train.idx', rec_val='/data/imagenet/train-480-val-256-recordio/val.rec', rec_val_idx='/data/imagenet/train-480-val-256-recordio/val.idx', resume_epoch=0, resume_params='', resume_states='', rgb_mean=[123.68, 116.779, 103.939], rgb_std=[58.393, 57.12, 57.375], save_dir='params', save_frequency=10, teacher=None, temperature=20, use_gn=False, use_pretrained=False, use_rec=True, use_se=False, warmup_epochs=0, warmup_lr=0.0, wd=0.0001)
DALI iterator does not support resetting while epoch is not finished. Ignoring...
Epoch[0] Batch [50]	Speed: 1218.686871 samples/sec	accuracy=0.003359	lr=0.100000
Epoch[0] Batch [100]	Speed: 1570.749233 samples/sec	accuracy=0.004238	lr=0.100000
Epoch[0] Batch [150]	Speed: 1673.371827 samples/sec	accuracy=0.005859	lr=0.100000
Epoch[0] Batch [200]	Speed: 1661.763066 samples/sec	accuracy=0.007334	lr=0.100000
Epoch[0] Batch [250]	Speed: 1668.642698 samples/sec	accuracy=0.009109	lr=0.100000
Epoch[0] Batch [300]	Speed: 1665.609134 samples/sec	accuracy=0.011419	lr=0.100000
Epoch[0] Batch [350]	Speed: 1663.183196 samples/sec	accuracy=0.013504	lr=0.100000
Epoch[0] Batch [400]	Speed: 1663.282360 samples/sec	accuracy=0.015825	lr=0.100000
Epoch[0] Batch [450]	Speed: 1663.841960 samples/sec	accuracy=0.018294	lr=0.100000
Epoch[0] Batch [500]	Speed: 1643.155890 samples/sec	accuracy=0.020605	lr=0.100000
Epoch[0] Batch [550]	Speed: 1671.200185 samples/sec	accuracy=0.023217	lr=0.100000
Epoch[0] Batch [600]	Speed: 1707.789448 samples/sec	accuracy=0.025827	lr=0.100000
Epoch[0] Batch [650]	Speed: 1706.494890 samples/sec	accuracy=0.028474	lr=0.100000
Epoch[0] Batch [700]	Speed: 1706.060410 samples/sec	accuracy=0.031189	lr=0.100000
Epoch[0] Batch [750]	Speed: 1707.843639 samples/sec	accuracy=0.033938	lr=0.100000
Epoch[0] Batch [800]	Speed: 1704.977558 samples/sec	accuracy=0.036584	lr=0.100000
Epoch[0] Batch [850]	Speed: 1714.673483 samples/sec	accuracy=0.039226	lr=0.100000
Epoch[0] Batch [900]	Speed: 1702.966374 samples/sec	accuracy=0.042027	lr=0.100000
Epoch[0] Batch [950]	Speed: 1564.380657 samples/sec	accuracy=0.044934	lr=0.100000
Epoch[0] Batch [1000]	Speed: 1656.424076 samples/sec	accuracy=0.047771	lr=0.100000
Epoch[0] Batch [1050]	Speed: 1660.058808 samples/sec	accuracy=0.050593	lr=0.100000
Epoch[0] Batch [1100]	Speed: 1666.981421 samples/sec	accuracy=0.053310	lr=0.100000
Epoch[0] Batch [1150]	Speed: 1677.290667 samples/sec	accuracy=0.056155	lr=0.100000
Epoch[0] Batch [1200]	Speed: 1698.675022 samples/sec	accuracy=0.058906	lr=0.100000
Epoch[0] Batch [1250]	Speed: 1696.605348 samples/sec	accuracy=0.061809	lr=0.100000
Epoch[0] Batch [1300]	Speed: 1694.107377 samples/sec	accuracy=0.064435	lr=0.100000
Epoch[0] Batch [1350]	Speed: 1669.510815 samples/sec	accuracy=0.067093	lr=0.100000
Epoch[0] Batch [1400]	Speed: 1644.090899 samples/sec	accuracy=0.069948	lr=0.100000
Epoch[0] Batch [1450]	Speed: 1709.710878 samples/sec	accuracy=0.072636	lr=0.100000
Epoch[0] Batch [1500]	Speed: 1694.790524 samples/sec	accuracy=0.075197	lr=0.100000
Epoch[0] Batch [1550]	Speed: 1666.095740 samples/sec	accuracy=0.078005	lr=0.100000
Epoch[0] Batch [1600]	Speed: 1707.371303 samples/sec	accuracy=0.080544	lr=0.100000
Epoch[0] Batch [1650]	Speed: 1697.434571 samples/sec	accuracy=0.083021	lr=0.100000
Epoch[0] Batch [1700]	Speed: 1700.114014 samples/sec	accuracy=0.085457	lr=0.100000
Epoch[0] Batch [1750]	Speed: 1705.873795 samples/sec	accuracy=0.088038	lr=0.100000
Epoch[0] Batch [1800]	Speed: 1694.299233 samples/sec	accuracy=0.090625	lr=0.100000
Epoch[0] Batch [1850]	Speed: 1692.750900 samples/sec	accuracy=0.093070	lr=0.100000
Epoch[0] Batch [1900]	Speed: 1700.477523 samples/sec	accuracy=0.095501	lr=0.100000
Epoch[0] Batch [1950]	Speed: 1701.868589 samples/sec	accuracy=0.097828	lr=0.100000
Epoch[0] Batch [2000]	Speed: 1696.456497 samples/sec	accuracy=0.099979	lr=0.100000
Epoch[0] Batch [2050]	Speed: 1707.497855 samples/sec	accuracy=0.102313	lr=0.100000
Epoch[0] Batch [2100]	Speed: 1672.709196 samples/sec	accuracy=0.104524	lr=0.100000
Epoch[0] Batch [2150]	Speed: 1678.328473 samples/sec	accuracy=0.106798	lr=0.100000
Epoch[0] Batch [2200]	Speed: 1692.052865 samples/sec	accuracy=0.108989	lr=0.100000
Epoch[0] Batch [2250]	Speed: 1692.791011 samples/sec	accuracy=0.111136	lr=0.100000
Epoch[0] Batch [2300]	Speed: 1689.839013 samples/sec	accuracy=0.113310	lr=0.100000
Epoch[0] Batch [2350]	Speed: 1697.545376 samples/sec	accuracy=0.115403	lr=0.100000
Epoch[0] Batch [2400]	Speed: 1691.433869 samples/sec	accuracy=0.117485	lr=0.100000
Epoch[0] Batch [2450]	Speed: 1694.845739 samples/sec	accuracy=0.119563	lr=0.100000
Epoch[0] Batch [2500]	Speed: 1684.009983 samples/sec	accuracy=0.121597	lr=0.100000
Epoch[0] Batch [2502]	Speed: 1131.959640 samples/sec	accuracy=0.121714	lr=0.100000
DALI iterator does not support resetting while epoch is not finished. Ignoring...
[Epoch 0] training: accuracy=0.121714
[Epoch 0] speed: 1667 samples/sec	time cost: 768.183942
[Epoch 0] validation: err-top1=0.762695 err-top5=0.523079
Epoch[1] Batch [50]	Speed: 1669.692466 samples/sec	accuracy=0.217422	lr=0.100000
Epoch[1] Batch [100]	Speed: 1684.061222 samples/sec	accuracy=0.220293	lr=0.100000
Epoch[1] Batch [150]	Speed: 1669.368316 samples/sec	accuracy=0.222578	lr=0.100000
Epoch[1] Batch [200]	Speed: 1700.150571 samples/sec	accuracy=0.223662	lr=0.100000
Epoch[1] Batch [250]	Speed: 1692.726696 samples/sec	accuracy=0.224992	lr=0.100000
Epoch[1] Batch [300]	Speed: 1710.076624 samples/sec	accuracy=0.226172	lr=0.100000
Epoch[1] Batch [350]	Speed: 1694.898656 samples/sec	accuracy=0.227238	lr=0.100000
Epoch[1] Batch [400]	Speed: 1710.000968 samples/sec	accuracy=0.228281	lr=0.100000
Epoch[1] Batch [450]	Speed: 1704.934215 samples/sec	accuracy=0.229861	lr=0.100000
Epoch[1] Batch [500]	Speed: 1717.815522 samples/sec	accuracy=0.231133	lr=0.100000
Epoch[1] Batch [550]	Speed: 1701.455064 samples/sec	accuracy=0.232930	lr=0.100000
Epoch[1] Batch [600]	Speed: 1701.944849 samples/sec	accuracy=0.234222	lr=0.100000
Epoch[1] Batch [650]	Speed: 1700.034365 samples/sec	accuracy=0.235258	lr=0.100000
Epoch[1] Batch [700]	Speed: 1702.940148 samples/sec	accuracy=0.236509	lr=0.100000
Epoch[1] Batch [750]	Speed: 1690.900372 samples/sec	accuracy=0.237638	lr=0.100000
Epoch[1] Batch [800]	Speed: 1701.588964 samples/sec	accuracy=0.238542	lr=0.100000
Epoch[1] Batch [850]	Speed: 1696.274014 samples/sec	accuracy=0.239341	lr=0.100000
Epoch[1] Batch [900]	Speed: 1702.829691 samples/sec	accuracy=0.240486	lr=0.100000
Epoch[1] Batch [950]	Speed: 1700.112587 samples/sec	accuracy=0.241530	lr=0.100000
Epoch[1] Batch [1000]	Speed: 1700.939854 samples/sec	accuracy=0.242684	lr=0.100000
Epoch[1] Batch [1050]	Speed: 1693.110546 samples/sec	accuracy=0.243560	lr=0.100000
Epoch[1] Batch [1100]	Speed: 1707.803545 samples/sec	accuracy=0.244428	lr=0.100000
Epoch[1] Batch [1150]	Speed: 1697.004020 samples/sec	accuracy=0.245306	lr=0.100000
Epoch[1] Batch [1200]	Speed: 1696.021781 samples/sec	accuracy=0.246213	lr=0.100000
Epoch[1] Batch [1250]	Speed: 1703.278631 samples/sec	accuracy=0.247284	lr=0.100000
Epoch[1] Batch [1300]	Speed: 1717.910616 samples/sec	accuracy=0.248278	lr=0.100000
Epoch[1] Batch [1350]	Speed: 1700.805436 samples/sec	accuracy=0.249261	lr=0.100000
Epoch[1] Batch [1400]	Speed: 1676.361338 samples/sec	accuracy=0.250201	lr=0.100000
Epoch[1] Batch [1450]	Speed: 1668.616741 samples/sec	accuracy=0.251207	lr=0.100000
Epoch[1] Batch [1500]	Speed: 1660.882483 samples/sec	accuracy=0.251932	lr=0.100000
Epoch[1] Batch [1550]	Speed: 1618.057573 samples/sec	accuracy=0.252708	lr=0.100000
Epoch[1] Batch [1600]	Speed: 1655.631262 samples/sec	accuracy=0.253408	lr=0.100000
Epoch[1] Batch [1650]	Speed: 1649.907840 samples/sec	accuracy=0.254225	lr=0.100000
Epoch[1] Batch [1700]	Speed: 1660.346489 samples/sec	accuracy=0.254986	lr=0.100000
Epoch[1] Batch [1750]	Speed: 1644.427997 samples/sec	accuracy=0.255776	lr=0.100000
Epoch[1] Batch [1800]	Speed: 1660.451452 samples/sec	accuracy=0.256572	lr=0.100000
Epoch[1] Batch [1850]	Speed: 1659.733435 samples/sec	accuracy=0.257457	lr=0.100000
Epoch[1] Batch [1900]	Speed: 1703.511027 samples/sec	accuracy=0.258095	lr=0.100000
Epoch[1] Batch [1950]	Speed: 1623.199815 samples/sec	accuracy=0.258877	lr=0.100000
Epoch[1] Batch [2000]	Speed: 1650.665719 samples/sec	accuracy=0.259498	lr=0.100000
Epoch[1] Batch [2050]	Speed: 1680.605887 samples/sec	accuracy=0.260168	lr=0.100000
Epoch[1] Batch [2100]	Speed: 1708.017616 samples/sec	accuracy=0.260710	lr=0.100000
Epoch[1] Batch [2150]	Speed: 1695.315585 samples/sec	accuracy=0.261566	lr=0.100000
Epoch[1] Batch [2200]	Speed: 1706.852912 samples/sec	accuracy=0.262274	lr=0.100000
Epoch[1] Batch [2250]	Speed: 1696.138993 samples/sec	accuracy=0.262916	lr=0.100000
Epoch[1] Batch [2300]	Speed: 1708.034190 samples/sec	accuracy=0.263684	lr=0.100000
Epoch[1] Batch [2350]	Speed: 1700.184544 samples/sec	accuracy=0.264291	lr=0.100000
Epoch[1] Batch [2400]	Speed: 1703.029875 samples/sec	accuracy=0.264914	lr=0.100000
Epoch[1] Batch [2450]	Speed: 1624.041251 samples/sec	accuracy=0.265578	lr=0.100000
Epoch[1] Batch [2500]	Speed: 1656.394971 samples/sec	accuracy=0.266316	lr=0.100000
Epoch[1] Batch [2501]	Speed: 826.662682 samples/sec	accuracy=0.266331	lr=0.100000
[Epoch 1] training: accuracy=0.266331
[Epoch 1] speed: 1684 samples/sec	time cost: 760.184340
[Epoch 1] validation: err-top1=0.680405 err-top5=0.420819
Epoch[2] Batch [50]	Speed: 1734.676168 samples/sec	accuracy=0.292422	lr=0.100000
Epoch[2] Batch [100]	Speed: 1718.446005 samples/sec	accuracy=0.296328	lr=0.100000
Epoch[2] Batch [150]	Speed: 1724.158468 samples/sec	accuracy=0.297383	lr=0.100000
Epoch[2] Batch [200]	Speed: 1705.509493 samples/sec	accuracy=0.298604	lr=0.100000
Epoch[2] Batch [250]	Speed: 1628.779944 samples/sec	accuracy=0.298930	lr=0.100000
Epoch[2] Batch [300]	Speed: 1655.867819 samples/sec	accuracy=0.299857	lr=0.100000
Epoch[2] Batch [350]	Speed: 1695.431093 samples/sec	accuracy=0.300352	lr=0.100000
Epoch[2] Batch [400]	Speed: 1704.518360 samples/sec	accuracy=0.301177	lr=0.100000
Epoch[2] Batch [450]	Speed: 1708.455785 samples/sec	accuracy=0.301988	lr=0.100000
Epoch[2] Batch [500]	Speed: 1703.641656 samples/sec	accuracy=0.302605	lr=0.100000
Epoch[2] Batch [550]	Speed: 1703.300597 samples/sec	accuracy=0.303256	lr=0.100000
Epoch[2] Batch [600]	Speed: 1703.309271 samples/sec	accuracy=0.303424	lr=0.100000
Epoch[2] Batch [650]	Speed: 1706.837501 samples/sec	accuracy=0.303486	lr=0.100000
Epoch[2] Batch [700]	Speed: 1691.354605 samples/sec	accuracy=0.303502	lr=0.100000
Epoch[2] Batch [750]	Speed: 1696.064002 samples/sec	accuracy=0.304078	lr=0.100000
Epoch[2] Batch [800]	Speed: 1703.989341 samples/sec	accuracy=0.304353	lr=0.100000
Epoch[2] Batch [850]	Speed: 1695.963489 samples/sec	accuracy=0.304651	lr=0.100000
Epoch[2] Batch [900]	Speed: 1703.206276 samples/sec	accuracy=0.305404	lr=0.100000
Epoch[2] Batch [950]	Speed: 1695.074662 samples/sec	accuracy=0.305866	lr=0.100000
Epoch[2] Batch [1000]	Speed: 1666.620786 samples/sec	accuracy=0.306156	lr=0.100000
Epoch[2] Batch [1050]	Speed: 1657.975808 samples/sec	accuracy=0.306516	lr=0.100000
Epoch[2] Batch [1100]	Speed: 1661.289783 samples/sec	accuracy=0.306717	lr=0.100000
Epoch[2] Batch [1150]	Speed: 1658.098522 samples/sec	accuracy=0.306941	lr=0.100000
Epoch[2] Batch [1200]	Speed: 1672.764858 samples/sec	accuracy=0.307269	lr=0.100000
Epoch[2] Batch [1250]	Speed: 1703.482487 samples/sec	accuracy=0.307630	lr=0.100000
Epoch[2] Batch [1300]	Speed: 1705.239692 samples/sec	accuracy=0.307870	lr=0.100000
Epoch[2] Batch [1350]	Speed: 1700.160424 samples/sec	accuracy=0.308118	lr=0.100000
Epoch[2] Batch [1400]	Speed: 1700.722140 samples/sec	accuracy=0.308573	lr=0.100000
Epoch[2] Batch [1450]	Speed: 1708.544653 samples/sec	accuracy=0.309106	lr=0.100000
Epoch[2] Batch [1500]	Speed: 1708.426156 samples/sec	accuracy=0.309448	lr=0.100000
Epoch[2] Batch [1550]	Speed: 1695.332074 samples/sec	accuracy=0.309832	lr=0.100000
Epoch[2] Batch [1600]	Speed: 1696.786883 samples/sec	accuracy=0.310095	lr=0.100000
Epoch[2] Batch [1650]	Speed: 1698.972346 samples/sec	accuracy=0.310343	lr=0.100000
Epoch[2] Batch [1700]	Speed: 1699.369738 samples/sec	accuracy=0.310515	lr=0.100000
Epoch[2] Batch [1750]	Speed: 1693.226421 samples/sec	accuracy=0.310975	lr=0.100000
Epoch[2] Batch [1800]	Speed: 1697.740051 samples/sec	accuracy=0.311268	lr=0.100000
Epoch[2] Batch [1850]	Speed: 1693.535651 samples/sec	accuracy=0.311696	lr=0.100000
Epoch[2] Batch [1900]	Speed: 1691.216211 samples/sec	accuracy=0.312043	lr=0.100000
Epoch[2] Batch [1950]	Speed: 1695.775247 samples/sec	accuracy=0.312308	lr=0.100000
Epoch[2] Batch [2000]	Speed: 1692.079583 samples/sec	accuracy=0.312552	lr=0.100000
Epoch[2] Batch [2050]	Speed: 1698.941539 samples/sec	accuracy=0.312810	lr=0.100000
Epoch[2] Batch [2100]	Speed: 1689.657712 samples/sec	accuracy=0.313007	lr=0.100000
Epoch[2] Batch [2150]	Speed: 1644.427292 samples/sec	accuracy=0.313379	lr=0.100000
Epoch[2] Batch [2200]	Speed: 1659.768199 samples/sec	accuracy=0.313680	lr=0.100000
Epoch[2] Batch [2250]	Speed: 1671.391232 samples/sec	accuracy=0.313987	lr=0.100000
Epoch[2] Batch [2300]	Speed: 1659.063025 samples/sec	accuracy=0.314413	lr=0.100000
Epoch[2] Batch [2350]	Speed: 1660.512592 samples/sec	accuracy=0.314614	lr=0.100000
Epoch[2] Batch [2400]	Speed: 1636.791131 samples/sec	accuracy=0.314896	lr=0.100000
Epoch[2] Batch [2450]	Speed: 1653.600351 samples/sec	accuracy=0.315176	lr=0.100000
Epoch[2] Batch [2500]	Speed: 1695.782318 samples/sec	accuracy=0.315484	lr=0.100000
Epoch[2] Batch [2501]	Speed: 858.693260 samples/sec	accuracy=0.315488	lr=0.100000
[Epoch 2] training: accuracy=0.315488
[Epoch 2] speed: 1687 samples/sec	time cost: 758.627593
[Epoch 2] validation: err-top1=0.625544 err-top5=0.359959
Training time for 3 epochs: 2343.487562 sec.
