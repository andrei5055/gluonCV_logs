When '--data-backend' is equal to 'dali-gpu', then `--num-gpus` should NOT be 0
For now '--num-gpus' will be set to the number of GPUs installed: 8
Namespace(batch_norm=False, batch_size=32, batchnorm_layout='NCHW', conv_layout='NCHW', crop_ratio=0.875, dali_fuse_decoder=1, dali_nvjpeg_memory_padding=64, dali_prefetch_queue=2, dali_separ_val=False, dali_threads=3, dali_validation_threads=10, data_backend='dali-gpu', data_dir='/data/imagenet/train-480-val-256-recordio', data_pred=None, data_val_resize=256, dtype='float32', flag=1, hard_weight=0.5, image_shape=[3, 224, 224], input_layout='NCHW', input_size=224, kv_store='device', label_smoothing=False, last_gamma=False, log_interval=50, logging_file='train_imagenet.log', lr=0.1, lr_decay=0.1, lr_decay_epoch='40,60', lr_decay_period=0, lr_mode='step', mixup=False, mixup_alpha=0.2, mixup_off_epoch=0, mode=None, model='resnet18_v1', momentum=0.9, no_wd=False, num_epochs=3, num_examples=1281167, num_gpus=8, num_training_samples=1281167, num_workers=4, pooling_layout='NCHW', rec_train='/data/imagenet/train-480-val-256-recordio/train.rec', rec_train_idx='/data/imagenet/train-480-val-256-recordio/train.idx', rec_val='/data/imagenet/train-480-val-256-recordio/val.rec', rec_val_idx='/data/imagenet/train-480-val-256-recordio/val.idx', resume_epoch=0, resume_params='', resume_states='', rgb_mean=[123.68, 116.779, 103.939], rgb_std=[58.393, 57.12, 57.375], save_dir='params', save_frequency=10, teacher=None, temperature=20, use_gn=False, use_pretrained=False, use_rec=True, use_se=False, warmup_epochs=0, warmup_lr=0.0, wd=0.0001)
DALI iterator does not support resetting while epoch is not finished. Ignoring...
Epoch[0] Batch [50]	Speed: 1725.607810 samples/sec	accuracy=0.008105	lr=0.100000
Epoch[0] Batch [100]	Speed: 1938.263205 samples/sec	accuracy=0.015752	lr=0.100000
Epoch[0] Batch [150]	Speed: 1927.877476 samples/sec	accuracy=0.024691	lr=0.100000
Epoch[0] Batch [200]	Speed: 1928.569921 samples/sec	accuracy=0.034333	lr=0.100000
Epoch[0] Batch [250]	Speed: 1929.765966 samples/sec	accuracy=0.044521	lr=0.100000
Epoch[0] Batch [300]	Speed: 1938.599976 samples/sec	accuracy=0.054875	lr=0.100000
Epoch[0] Batch [350]	Speed: 1932.674449 samples/sec	accuracy=0.065067	lr=0.100000
Epoch[0] Batch [400]	Speed: 1933.544195 samples/sec	accuracy=0.074908	lr=0.100000
Epoch[0] Batch [450]	Speed: 1934.765951 samples/sec	accuracy=0.084563	lr=0.100000
Epoch[0] Batch [500]	Speed: 1937.765053 samples/sec	accuracy=0.093752	lr=0.100000
Epoch[0] Batch [550]	Speed: 1923.229837 samples/sec	accuracy=0.102713	lr=0.100000
Epoch[0] Batch [600]	Speed: 1922.579569 samples/sec	accuracy=0.111284	lr=0.100000
Epoch[0] Batch [625]	Speed: 1855.615099 samples/sec	accuracy=0.115606	lr=0.100000
DALI iterator does not support resetting while epoch is not finished. Ignoring...
[Epoch 0] training: accuracy=0.115606
[Epoch 0] speed: 1910 samples/sec	time cost: 670.113517
[Epoch 0] validation: err-top1=0.760938 err-top5=0.525078
Epoch[1] Batch [50]	Speed: 1929.082409 samples/sec	accuracy=0.223350	lr=0.100000
Epoch[1] Batch [100]	Speed: 1930.482918 samples/sec	accuracy=0.230249	lr=0.100000
Epoch[1] Batch [150]	Speed: 1929.569146 samples/sec	accuracy=0.235075	lr=0.100000
Epoch[1] Batch [200]	Speed: 1926.200337 samples/sec	accuracy=0.239119	lr=0.100000
Epoch[1] Batch [250]	Speed: 1931.248824 samples/sec	accuracy=0.243584	lr=0.100000
Epoch[1] Batch [300]	Speed: 1929.767232 samples/sec	accuracy=0.248381	lr=0.100000
Epoch[1] Batch [350]	Speed: 1924.507884 samples/sec	accuracy=0.252768	lr=0.100000
Epoch[1] Batch [400]	Speed: 1914.834083 samples/sec	accuracy=0.256781	lr=0.100000
Epoch[1] Batch [450]	Speed: 1930.327967 samples/sec	accuracy=0.260511	lr=0.100000
Epoch[1] Batch [500]	Speed: 1927.384985 samples/sec	accuracy=0.264086	lr=0.100000
Epoch[1] Batch [550]	Speed: 1926.991820 samples/sec	accuracy=0.267866	lr=0.100000
Epoch[1] Batch [600]	Speed: 1929.537479 samples/sec	accuracy=0.271203	lr=0.100000
Epoch[1] Batch [625]	Speed: 1847.858032 samples/sec	accuracy=0.273041	lr=0.100000
[Epoch 1] training: accuracy=0.273041
[Epoch 1] speed: 1924 samples/sec	time cost: 665.248985
[Epoch 1] validation: err-top1=0.659729 err-top5=0.395854
Epoch[2] Batch [50]	Speed: 1928.010674 samples/sec	accuracy=0.313555	lr=0.100000
Epoch[2] Batch [100]	Speed: 1937.470549 samples/sec	accuracy=0.318437	lr=0.100000
Epoch[2] Batch [150]	Speed: 1932.760429 samples/sec	accuracy=0.320309	lr=0.100000
Epoch[2] Batch [200]	Speed: 1925.407667 samples/sec	accuracy=0.322310	lr=0.100000
Epoch[2] Batch [250]	Speed: 1927.591585 samples/sec	accuracy=0.324145	lr=0.100000
Epoch[2] Batch [300]	Speed: 1927.735870 samples/sec	accuracy=0.326133	lr=0.100000
Epoch[2] Batch [350]	Speed: 1931.034025 samples/sec	accuracy=0.328004	lr=0.100000
Epoch[2] Batch [400]	Speed: 1926.420586 samples/sec	accuracy=0.329663	lr=0.100000
Epoch[2] Batch [450]	Speed: 1923.850831 samples/sec	accuracy=0.331305	lr=0.100000
Epoch[2] Batch [500]	Speed: 1920.726903 samples/sec	accuracy=0.332844	lr=0.100000
Epoch[2] Batch [550]	Speed: 1922.851700 samples/sec	accuracy=0.334279	lr=0.100000
Epoch[2] Batch [600]	Speed: 1919.639187 samples/sec	accuracy=0.335861	lr=0.100000
Epoch[2] Batch [624]	Speed: 1849.794072 samples/sec	accuracy=0.336758	lr=0.100000
[Epoch 2] training: accuracy=0.336758
[Epoch 2] speed: 1923 samples/sec	time cost: 664.295108
[Epoch 2] validation: err-top1=0.616816 err-top5=0.354453
Training time for 3 epochs: 2048.373948 sec.
